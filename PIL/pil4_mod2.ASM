;MODULE 2
PUBLIC CONCATENATE
PUBLIC COMPARESTR
PUBLIC CHARSPACE


EXTRN STR1:BYTE
EXTRN STR2:BYTE

.MODEL SMALL
DISP MACRO M1
LEA DX,M1
MOV AH,09H
INT 21H
ENDM
.DATA
MSG3 DB 10,13,"CONCATENATED STRING IS :$"
MSG4 DB 10,13,"THE STRING IS A SUBSTRING :$"
MSG5 DB 10,13,"THE STRING IS NOT A SUBSTRING $"
MSG6 DB 10,13,"THE NUMBER OF CHARACTERS ARE : $"
MSG7 DB 10,13,"THE NUMBER OF SPACES ARE : $"
MSG8 DB 10,13,"THE STRINGS ARE EQUAL $"
MSG9 DB 10,13,"THE STRINGS ARE UNEQUAL $"

CNT DB 00H
.CODE
MOV AX,@DATA
MOV DS,AX
MOV ES,AX

PROC CONCATENATE NEAR
DISP MSG3
LEA SI,STR1
INC SI
MOV CH,[SI]
LOOP2:INC SI
     MOV DX,[SI]
     MOV AH,02H
     INT 21H
     DEC CH
     JNZ LOOP2
LEA SI,STR2
MOV CH,[SI]
INC SI
MOV CH,[SI]
LOOP1:INC SI
      MOV DX,[SI]
      MOV AH,02H
      INT 21H
      DEC CH
      JNZ LOOP1
RET
ENDP

PROC COMPARESTR FAR
LEA SI,STR1
LEA DI,STR2
INC SI
INC DI
MOV CH,[SI]
MOV CL,[DI]
CMP CH,CL
JNZ UP1

MOV CH,00H
MOV CL,[SI]
LEA SI,STR1+2   ;EXECUTE IF LENGTH OF BOTH THE STRINGS ARE SAME
LEA DI,STR2+2
CLD
REPE CMPSB
JE DOWN
UP1: DISP MSG9  ;NOT EQUAL
JMP D1
DOWN : DISP MSG8 ;EQUAL

D1:RET
ENDP

PROC CHARSPACE FAR  ;PROCEDURE FOR NO. OF SPACES AND CHARACTERS
INC SI
MOV CH,[SI]
MOV CNT,CH
MOV CL,00H
LABEL1:INC SI
MOV BH,[SI]
CMP BH,020H
JNZ LABEL2
INC CL
LABEL2:DEC CNT
JNZ LABEL1

MOV BL,CL
SUB CH,CL
MOV BH,CH

DISP MSG7
CALL DISPLAY1
DISP MSG6
MOV BL,BH
CALL DISPLAY1
RET
ENDP

PROC DISPLAY1 NEAR
MOV CH,02H      ;2 DIGIT DISPLAY ROUTINE
MOV CL,04H
P1:ROL BL,CL
MOV DL,BL
AND DL,0FH
CMP DL,09H
JBE P2
ADD DL,07H
P2:ADD DL,30H
MOV AH,02H
INT 21H
DEC CH
JNZ P1
RET
ENDP

END